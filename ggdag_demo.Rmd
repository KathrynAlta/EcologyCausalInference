---
title: "ggdag_demo"
author: "Laura Dee"
date: "`r Sys.Date()`"
output: html_document
---

```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

## R Markdown

This is an R Markdown document. Markdown is a simple formatting syntax for authoring HTML, PDF, and MS Word documents. For more details on using R Markdown see <http://rmarkdown.rstudio.com>.

When you click the **Knit** button a document will be generated that includes both content as well as the output of any embedded R code chunks within the document. You can embed an R code chunk like this:

```{r cars}
library(ggdag)
require(knitr)
library(dagitty)
require(tidyr)
require(ddplyr)
library(tidyverse)
```

## Including Plots

You can also embed plots, for example:

```{r pressure, echo=FALSE}
plot(pressure)
```

Note that the `echo = FALSE` parameter was added to the code chunk to prevent printing of the R code that generated the plot.

## So now we just have past richness affecting current exotic (not contemporaneous because otherwise isnt acyclic graph)!
```{r}
richness_dag <- dagify(Native_psy ~ Exotic_psy + NPKTreatment + Exotics_yr0 + Native_yr0 + Ndep_sy + Climate_sy + SoilFert_yr0 +  livestock_sy + Dist_to_Road_s + Oldfield_past_s + pastlivestock_yr0, 
                #is there anything else I missed in the native diversity not in the exotic? or vice versa?
 Exotic_psy ~  NPKTreatment + Exotics_yr0 + Native_yr0 + Ndep_sy + Climate_sy + SoilFert_yr0 +
 livestock_sy + Dist_to_Road_s + Oldfield_past_s + pastlivestock_yr0, 
 Ndep_sy ~  Climate_sy, 
Exotics_yr0 ~ Climate_sy + Ndep_sy + pastlivestock_yr0 + livestock_sy + Dist_to_Road_s + SoilFert_yr0,
                # Did you have Native div in year 0 related to N deposition too?
                # wouldn't native and invasive diversity in year 0 be related too?
 Native_yr0 ~ Climate_sy + pastlivestock_yr0 + livestock_sy + SoilFert_yr0, 
SoilFert_yr0 ~ Ndep_sy + Oldfield_past_s +  livestock_sy +  pastlivestock_yr0, 
  Oldfield_past_s  ~ Dist_to_Road_s, 
livestock_sy  ~ pastlivestock_yr0 + Dist_to_Road_s,
pastlivestock_yr0 ~ Dist_to_Road_s, 
exposure = "Exotic_psy", #wont run if current richess also effects current exotic 
 outcome = "Native_psy",
labels = c(outcome = "richness",
           exposure = "Exotic"))

set.seed(124)
ggdag(richness_dag, 
       use_labels = "label")

ggdag_status(richness_dag,
             use_labels = "label",
             text = TRUE,
             label_alpha = 0.5) +
   #guides(fill = FALSE, color = FALSE) +
  theme_dag()
  #identify the paths that need to be adjusted for 
paths(richness_dag)
adjustmentSets(richness_dag)
ggdag_paths(richness_dag)
ggdag_paths(richness_dag, shadow = TRUE)
ggdag_adjustment_set(richness_dag, shadow = TRUE)
ggdag_descendants(richness_dag, "Climate_sy")
ggdag_descendants(richness_dag, "Ndep_sy")

impliedConditionalIndependencies(richness_dag)
# We can also find all the paths between x and y using the paths() function from the dagitty package. We can see that there are three open paths between x and y:

paths(richness_dag)
```
